/**
 * @copyright Copyright The SimpleKernel Contributors
 */

#ifndef SIMPLEKERNEL_SRC_LIBCXX_INCLUDE_KSTD_MEMORY_
#define SIMPLEKERNEL_SRC_LIBCXX_INCLUDE_KSTD_MEMORY_

#include <etl/memory.h>

/**
 * @brief Kernel memory utilities wrapping etl::unique_ptr.
 *
 * @note kstd::make_unique requires heap allocation via ::operator new.
 * It MUST only be used after MemoryInit() has been called during kernel boot.
 */
namespace kstd {

/**
 * @brief Create a unique_ptr, constructing T in-place from args.
 *
 * Equivalent to etl::unique_ptr<T>(new T(args...)).
 *
 * @pre  MemoryInit() must have been called.
 * @tparam T    Type of the managed object.
 * @tparam Args Constructor argument types.
 */
template <typename T, typename... Args>
auto make_unique(Args&&... args) -> etl::unique_ptr<T> {
  return etl::unique_ptr<T>(new T(etl::forward<Args>(args)...));
}

}  // namespace kstd

#endif  // SIMPLEKERNEL_SRC_LIBCXX_INCLUDE_KSTD_MEMORY_
